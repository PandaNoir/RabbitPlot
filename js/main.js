var appName="rabbit",MEMO_LIMIT=1950,QUOTATION=0,isSmartPhone=0<navigator.userAgent.indexOf("iPhone")&&-1==navigator.userAgent.indexOf("iPad")||0<navigator.userAgent.indexOf("iPod")||0<navigator.userAgent.indexOf("Android");
angular.module(appName,["ngTouch","ngAnimate","ngMaterial","ngMessages"]).controller("mainCtrl",["$scope","eventForm","calF","eventCal","eventListToEdit","$timeout","$filter","$sce","$mdSidenav",function(a,c,e,d,b,k,f,g,l){a._=_;a.eventForm=c;a.calF=e;a.eventListToEdit=b;a.eventForm.isEditMode=!1;a.showsHowToWrite=!1;a.showHowToWrite=function(){a.showsHowToWrite=!a.showsHowToWrite};a.splitSelector=d.splitSelector;a.openNav=function(){l("left").toggle()};a.calF.selected=a.calF.date;a.eventCalendar=
d.eventCalendar}]).config(["$httpProvider",function(a){a.defaults.transformRequest=function(a){if(void 0===a)return a;if(angular.isObject(a)){var e=[],d;for(d in a)if(a.hasOwnProperty(d)){var b=a[d];e[e.length]=encodeURIComponent(d)+"="+encodeURIComponent(null==b?"":b)}a=e.join("&").replace(/%20/g,"+")}else a=null==a?"":a.toString();return a};a.defaults.headers.post={"Content-Type":"application/x-www-form-urlencoded"}}]).filter("format",["group","user",function(a,c){return function(e,d){e=e.split(":");
var b="",b="private"==e[1]?c["private"][e[2]][e[0]].name:a[e[1]][e[2]][e[0]].name;!1!==d&&0===b.indexOf("[mes]")&&(b=b.replace(/^\[mes\]/,""));return b}}]).run(["db","group","$rootScope",function(a,c,e){var d={id:0,event:[{name:"[mes]\u6625\u5206\u306e\u65e5",year:2E3,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2E3,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2001,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2001,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",
year:2002,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2002,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2003,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2003,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2004,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2004,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2005,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2005,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",
year:2006,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2006,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2007,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2007,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2008,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2008,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2009,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2009,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",
year:2010,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2010,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2011,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2011,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2012,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2012,month:8,date:22},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2013,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2013,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",
year:2014,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2014,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2015,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2015,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2016,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2016,month:8,date:22},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2017,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2017,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",
year:2018,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2018,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2019,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2019,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2020,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2020,month:8,date:22},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2021,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2021,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",
year:2022,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2022,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2023,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2023,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2024,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2024,month:8,date:22},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2025,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2025,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",
year:2026,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2026,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2027,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2027,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2028,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2028,month:8,date:22},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2029,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2029,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",
year:2030,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2030,month:8,date:23},{name:"[mes]\u5341\u4e94\u591c",year:2E3,month:8,date:12},{name:"[mes]\u5341\u4e94\u591c",year:2001,month:9,date:1},{name:"[mes]\u5341\u4e94\u591c",year:2002,month:8,date:21},{name:"[mes]\u5341\u4e94\u591c",year:2003,month:8,date:11},{name:"[mes]\u5341\u4e94\u591c",year:2004,month:8,date:28},{name:"[mes]\u5341\u4e94\u591c",year:2005,month:8,date:18},{name:"[mes]\u5341\u4e94\u591c",year:2006,month:9,date:6},
{name:"[mes]\u5341\u4e94\u591c",year:2007,month:8,date:25},{name:"[mes]\u5341\u4e94\u591c",year:2008,month:8,date:14},{name:"[mes]\u5341\u4e94\u591c",year:2009,month:9,date:3},{name:"[mes]\u5341\u4e94\u591c",year:2010,month:8,date:22},{name:"[mes]\u5341\u4e94\u591c",year:2011,month:8,date:12},{name:"[mes]\u5341\u4e94\u591c",year:2012,month:8,date:30},{name:"[mes]\u5341\u4e94\u591c",year:2013,month:8,date:19},{name:"[mes]\u5341\u4e94\u591c",year:2014,month:8,date:8},{name:"[mes]\u5341\u4e94\u591c",
year:2015,month:8,date:27},{name:"[mes]\u5341\u4e94\u591c",year:2016,month:8,date:15}],habit:[{name:"[mes]\u5143\u65e6",selector:"month:1 date:1"},{name:"[mes]\u6210\u4eba\u306e\u65e5",selector:"month:1 day:2nd-mon"},{name:"[mes]\u662d\u548c\u306e\u65e5",selector:"month:4 date:29"},{name:"[mes]\u5efa\u56fd\u8a18\u5ff5\u65e5",selector:"month:2 date:11"},{name:"[mes]\u61b2\u6cd5\u8a18\u5ff5\u65e5",selector:"month:5 date:3"},{name:"[mes]\u307f\u3069\u308a\u306e\u65e5",selector:"month:5 date:4"},{name:"[mes]\u3053\u3069\u3082\u306e\u65e5",
selector:"month:5 date:5"},{name:"[mes]\u6d77\u306e\u65e5",selector:"month:7 day:3rd-mon"},{name:"[mes]\u656c\u8001\u306e\u65e5",selector:"month:9 day:3rd-mon"},{name:"[mes]\u4f53\u80b2\u306e\u65e5",selector:"month:10 day:2nd-mon"},{name:"[mes]\u6587\u5316\u306e\u65e5",selector:"month:11 date:3"},{name:"[mes]\u52e4\u52b4\u611f\u8b1d\u306e\u65e5",selector:"month:11 date:23"},{name:"[mes]\u5929\u7687\u8a95\u751f\u65e5",selector:"month:12 date:23"}],name:"\u795d\u65e5",updated:!0};localStorage&&localStorage.getItem("group")&&
(c.length=0,Array.prototype.push.apply(c,angular.fromJson(localStorage.getItem("group"))),c[0]=_.clone(d));a.list().then(function(b){b=b.data;for(var k=0,f=b.length;k<f;k++){for(var g in b[k])b[k][g]=angular.fromJson(b[k][g]);b[k].updated=!0}b.sort(function(a,b){return a.id-b.id});k=c.length=0;for(f=b.length;k<f;k++)c[b[k].id]=b[k];c[0]=_.clone(d);e.$broadcast("updated");localStorage.setItem("group",angular.toJson(c));a.getNameList().then(function(a){for(var b=0,e=a.data[0].length;b<e;b++)c[b]||(c[b]=
{name:angular.fromJson(a.data[0][b])},a.data[1][b]&&(c[b].parents=angular.fromJson(a.data[1][b])));c[0]=_.clone(d);localStorage.setItem("group",angular.toJson(c))})})}]).directive("appDate",[function(){return{scope:{row:"=appRow"},restrict:"A",template:'<span class="date" ng-transclude></span>',transclude:!0,replace:!0,controller:["$scope","calF","eventCal","$filter",function(a,c,e,d){a.calendar=c;a.bookedClass=function(a){a=e.eventCalendar(a);for(var c=0,f=0,g=a.length;f<g;f++)0!==d("format")(a[f],
!1).indexOf("[mes]")&&c++;return 5>c?"booked-"+c:"booked-5"};a.dateClass=function(b){if(0!==b&&32!==b){var c=a.calendar,e=[];c.selected===b&&(e[e.length]="selected");e[e.length]=a.bookedClass(b);b===c.today.date&&c.month===c.today.month&&c.year===c.today.year&&(e[e.length]="today");return e}return[]}}],link:function(a,c,e){var d=a.row[e.appDate];if(""!==d&&void 0!==d){var b=function(){c.removeClass("selected booked-0 booked-1 booked-2 booked-3 booked-4 booked-5 today");c.addClass(a.dateClass(d).join(" "))};
a.$on("updated",b);b();c.on("mouseenter",function(){!a.calendar.disableHoverEvent&&d&&(a.calendar.selected=d,angular.element(document.querySelectorAll(".selected")).removeClass("selected"),b(),a.$apply())});c.on("mouseleave",function(){a.calendar.disableHoverEvent||(a.calendar.selected=null,angular.element(document.querySelectorAll(".selected")).removeClass("selected"),a.$apply())});c.on("click",function(){isSmartPhone||(a.calendar.disableHoverEvent=a.calendar.selected===d?!a.calendar.disableHoverEvent:
!0);a.calendar.selected=d;angular.element(document.querySelectorAll(".selected")).removeClass("selected");b();a.$apply()})}}}}]);angular.module(appName).controller("calendarCtrl",["$scope","calF","eventForm",function(a,c,e){a.calF=c;a.nextMonth=function(){a.calF.month++;a.calF.selected=null;12<a.calF.month+1&&(a.calF.year+=1,a.calF.month-=12);e.isEditMode=!1};a.lastMonth=function(){a.calF.month--;a.calF.selected=null;1>a.calF.month+1&&(a.calF.year-1<MEMO_LIMIT?(alert(MEMO_LIMIT+"\u5e74\u3088\u308a\u4ee5\u524d\u306f\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306e\u95a2\u4fc2\u3067\u8868\u793a\u3067\u304d\u307e\u305b\u3093\u3002"),
a.calF.month+=1):(a.calF.month+=12,a.calF.year-=1));e.isEditMode=!1};a.nextYear=function(){a.calF.year++;a.calF.selected=null;e.isEditMode=!1};a.lastYear=function(){a.calF.year-1<MEMO_LIMIT?alert(MEMO_LIMIT+"\u5e74\u3088\u308a\u4ee5\u524d\u306f\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306e\u95a2\u4fc2\u3067\u8868\u793a\u3067\u304d\u307e\u305b\u3093\u3002"):(a.calF.year--,a.calF.selected=null);e.isEditMode=!1}}]);angular.module(appName).controller("eventEditorCtrl",["$scope","group","user","eventForm","calF","db","$mdToast",function(a,c,e,d,b,k,f){function g(b){"private"===b?e.save():k.post(a.group[b],b,"update")}var l=[],p=[];a.group=c;a.user=e;a.eventForm=d;a.calF=b;a.ruleWriterFase="";a.ruleInput="";a.eventEditor={rules:"",selectedGroup:""};a.addEvent=function(){var b=a.eventForm.type;if(""!==d.name&&void 0!==d.selectedGroup&&null!==d.selectedGroup){var c=new Date(d.year,d.month-1,d.date);if(c.getFullYear()===
parseInt(d.year,10)&&c.getMonth()===parseInt(d.month,10)-1&&c.getDate()===parseInt(d.date,10)){if("event"==b)var e={year:d.year,month:d.month-1,date:d.date,name:d.name};else"habit"==b&&(e={selector:d.rule,name:d.name});"private"===d.selectedGroup?(a.user["private"][b][a.user["private"][b].length]=e,a.user.updated=!0):null!==d.selectedGroup&&(a.group[d.selectedGroup][b][a.group[d.selectedGroup][b].length]=e,a.group[d.selectedGroup].updated=!0);f.show(f.simple().content("\u30a4\u30d9\u30f3\u30c8\u3092\u8ffd\u52a0\u3057\u307e\u3057\u305f").position("top right").hideDelay(3E3));
d.isEditMode=!1;g(d.selectedGroup)}}};a.saveEvent=function(){var b=d.type;if(null!==d.year&&null!==d.month&&null!==d.date&&""!==d.name){var c=new Date(d.year,d.month-1,d.date);if(c.getFullYear()===parseInt(d.year,10)&&c.getMonth()===parseInt(d.month,10)-1&&c.getDate()===parseInt(d.date,10)){if("private"===d.selectedGroup)var e=a.user["private"][b][d.id];else null!==d.selectedGroup&&(e=a.group[d.selectedGroup][b][d.id],a.group[d.selectedGroup].updated=!0);"event"==b?(e.year=d.year,e.month=d.month-
1,e.date=d.date,e.name=d.name):"habit"==b&&(e.selector=d.rule,e.name=d.name);d.isEditMode=!1;g(d.selectedGroup)}}};a.cancel=function(){d.isEditMode=!1};a.goFase=function(b,c){l[l.length]=a.ruleWriterFase;p[p.length]=c||b;a.ruleWriterFase=b;d.rule=p.join("")};a.cancelFase=function(){a.ruleWriterFase=l.pop();p.pop();d.rule=p.join("")};a.finishWritingRule=function(){a.ruleWriterFase="";l=[];d.rule=p.join("");p=[]};a.startWritingRule=function(){a.ruleWriterFase="selector";l=[];p=[]}}]);angular.module(appName).controller("groupEditorCtrl",["$scope","group","groupForm","db","$mdToast",function(a,c,e,d,b){a.groupForm=e;a.groupForm.parentGroup=[null];a.groupForm.mode="add";a.group=c;a.finishMakingAGroup=function(){e.isEditMode=!1};a.addGroup=function(){var e=a.groupForm.parentGroup.reduce(function(a,b){-1===a.indexOf(b)&&(a[a.length]=angular.isNumber(b)?parseInt(b,10):"");return a},[]),f={event:[],habit:[],name:a.groupForm.name,updated:!0};""!==e.join("")&&(f.parents=e);c[c.length]=
f;d.post(f,a.group.length-1,"insert").success(a.finishMakingAGroup);b.show(b.simple().content("\u30b0\u30eb\u30fc\u30d7 "+a.groupForm.name+" \u3092\u4f5c\u6210\u3057\u307e\u3057\u305f").position("top right").hideDelay(3E3));a.groupForm.name=""}}]);angular.module(appName).controller("detailCtrl",["$scope","eventForm","user","group",function(a,c,e,d){a.switchToEdit=function(){arguments=Array.prototype.slice.call(arguments);if(1===arguments.length){var b=arguments[0];a.eventForm.mode="edit";b=b.split(":");c.type=b[2];c.id=b[0];c.selectedGroup="private"!==b[1]?parseInt(b[1],10):b[1];"event"===b[2]?"private"===b[1]?(c.year=e["private"].event[b[0]].year,c.month=e["private"].event[b[0]].month+1,c.date=e["private"].event[b[0]].date,c.name=e["private"].event[b[0]].name):
(c.year=d[b[1]].event[b[0]].year,c.month=d[b[1]].event[b[0]].month+1,c.date=d[b[1]].event[b[0]].date,c.name=d[b[1]].event[b[0]].name):"habit"===b[2]&&("private"===b[1]?(c.rule=e["private"].habit[b[0]].selector,c.name=e["private"].habit[b[0]].name):(c.rule=d[b[1]].habit[b[0]].selector,c.name=d[b[1]].habit[b[0]].name))}else 2===arguments.length&&!0===arguments[1]?(b=arguments[0],a.eventForm.mode="add",b=b.split(":"),c.type=b[2],c.id=0,c.selectedGroup="private"!==b[1]?parseInt(b[1],10):b[1],"event"===
b[2]?"private"===b[1]?(c.year=e["private"].event[b[0]].year,c.month=e["private"].event[b[0]].month+1,c.date=e["private"].event[b[0]].date,c.name=e["private"].event[b[0]].name):(c.year=d[b[1]].event[b[0]].year,c.month=d[b[1]].event[b[0]].month+1,c.date=d[b[1]].event[b[0]].date,c.name=d[b[1]].event[b[0]].name):"habit"===b[2]&&("private"===b[1]?(c.rule=e["private"].habit[b[0]].selector,c.name=e["private"].habit[b[0]].name):(c.rule=d[b[1]].habit[b[0]].selector,c.name=d[b[1]].habit[b[0]].name))):3===arguments.length&&
(c.mode="add",c.type="event",c.rule="",c.id=0,c.name="",c.year=arguments[0],c.month=arguments[1]+1,c.date=arguments[2]);a.eventForm.isEditMode=!0}}]);angular.module(appName).controller("settingCtrl",["$scope","group","user","db","eventListToEdit","groupForm","$mdSidenav","$mdToast","$mdDialog",function(a,c,e,d,b,k,f,g,l){function p(a,b){return a-b}function w(b){return-1!==a.user.following.indexOf(b)}function u(a){if(!c[a].parents)return[];for(var b=c[a].parents,e=0,d=c[a].parents.length;e<d;e++)b=u(c[a].parents[e]).concat(b);return b}a.group=c;a.user=e;a.groupForm=k;a.search_keyword="";a.searchResult=[];a.hide=function(a){e.hiddenGroup[e.hiddenGroup.length]=
a;e.hiddenGroup.sort(p);e.save()};a.show=function(b){e.hiddenGroup=_.without(a.user.hiddenGroup,b);e.save()};a.followsParent=function(a){a=u(a);for(var b=0,c=a.length;b<c;b++)if(!w(a[b]))return a[b];return!0};a.toggleNav=function(){console.log("called");f("left").close()};a.follows=w;a.follow=function(b){a.user.following[a.user.following.length]=b;a.user.following.sort(p);e.save();g.show(g.simple().content(c[b].name+"\u3092\u30d5\u30a9\u30ed\u30fc\u3057\u307e\u3057\u305f").position("top right").hideDelay(3E3))};
a.unfollow=function(b){var d=[];d[d.length]=a.user.following.indexOf(b);for(var k=0,D=a.user.following.length;k<D;k++)if(c[a.user.following[k]].parents&&-1!=u(a.user.following[k]).indexOf(b)){if(!confirm("\u3053\u306e\u30b0\u30eb\u30fc\u30d7\u306e\u5b50\u30b0\u30eb\u30fc\u30d7("+c[a.user.following[k]].name+")\u3092\u30d5\u30a9\u30ed\u30fc\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e\u30b0\u30eb\u30fc\u30d7\u3092\u30d5\u30a9\u30ed\u30fc\u89e3\u9664\u3059\u308b\u3068\u3053\u3061\u3089\u3082\u89e3\u9664\u306b\u306a\u308a\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b?"))return;
d[d.length]=k}d.sort(function(a,b){return b-a});k=0;for(D=d.length;k<D;k++)a.user.following.splice(d[k],1);e.save()};a.showEventList=function(a){b.id=a};a.makeAGroup=function(){k.isEditMode=!0;f("left").close()};a.search=function(){var b=[];if(""==a.search_keyword)return b;for(var e=0,d=c.length;e<d&&!(30<b.length);e++)-1!==c[e].name.indexOf(a.search_keyword)&&(b[b.length]=e);a.searchResult=b};a.randomSearch=function(){var b=[];if(5>c.length)Array.prototype.push.apply(b,c);else for(;5>b.length;){var e=
Math.random()*c.length|0;-1===_.indexOf(b,e)&&(b[b.length]=e)}a.searchResult=b};a.hideAll=function(){e.hiddenGroup.length=0;e.hiddenGroup=_.clone(e.following);e.hiddenGroup[e.hiddenGroup.length]=-1;e.hiddenGroup.sort(p);e.save()};a.showAll=function(){e.hiddenGroup=[];e.save()};a.importSetting=function(){l.show({controller:function(b,a){b.text="";b.answer=function(b){a.hide(b)}},template:'<md-dialog><md-content>\u30b3\u30d4\u30fc\u3057\u305f\u30c7\u30fc\u30bf\u3092\u8cbc\u308a\u4ed8\u3051\u3066\u304f\u3060\u3055\u3044\u3002<br><input ng-model="text"><md-button ng-click="answer(text)">ok</md-button></md-content></md-dialog>'}).then(function(b){b=
JSON.parse(b);for(var a in b)e[a]=b[a];e.save()})};a.exportSetting=function(){l.show(l.alert().title("").content("\u3053\u308c\u3092\u30b3\u30d4\u30fc\u3057\u3066\u79fb\u884c\u5148\u3067\u8cbc\u308a\u4ed8\u3051\u3066\u304f\u3060\u3055\u3044\u3002"+angular.toJson(e)).ok("ok"))}}]).directive("autoFocus",function(){return{link:function(a,c,e){a.$watch("focus",function(e){!0===a.focus&&c[0].focus()})}}});angular.module(appName).controller("eventListCtrl",["$scope","group","user","eventListToEdit","eventForm",function(a,c,e,d,b){a.eventListToEdit=d;a.group=c;a.user=e;a.habitList="private"!==d.id?c[d.id].habit:e["private"].habit;a.eventList="private"!==d.id?c[d.id].event:e["private"].event;a.switchToEdit=function(){arguments=Array.prototype.slice.call(arguments);if(1===arguments.length){var d=arguments[0];a.eventForm.mode="edit";d=d.split(":");b.type=d[2];b.id=d[0];b.selectedGroup="private"!==d[1]?
parseInt(d[1],10):d[1];"event"===d[2]?"private"===d[1]?(b.year=e["private"].event[d[0]].year,b.month=e["private"].event[d[0]].month+1,b.date=e["private"].event[d[0]].date,b.name=e["private"].event[d[0]].name):(b.year=c[d[1]].event[d[0]].year,b.month=c[d[1]].event[d[0]].month+1,b.date=c[d[1]].event[d[0]].date,b.name=c[d[1]].event[d[0]].name):"habit"===d[2]&&("private"===d[1]?(b.rule=e["private"].habit[d[0]].selector,b.name=e["private"].habit[d[0]].name):(b.rule=c[d[1]].habit[d[0]].selector,b.name=
c[d[1]].habit[d[0]].name))}else 2===arguments.length&&!0===arguments[1]?(d=arguments[0],a.eventForm.mode="add",d=d.split(":"),b.type=d[2],b.id=0,b.selectedGroup="private"!==d[1]?parseInt(d[1],10):d[1],"event"===d[2]?"private"===d[1]?(b.year=e["private"].event[d[0]].year,b.month=e["private"].event[d[0]].month+1,b.date=e["private"].event[d[0]].date,b.name=e["private"].event[d[0]].name):(b.year=c[d[1]].event[d[0]].year,b.month=c[d[1]].event[d[0]].month+1,b.date=c[d[1]].event[d[0]].date,b.name=c[d[1]].event[d[0]].name):
"habit"===d[2]&&("private"===d[1]?(b.rule=e["private"].habit[d[0]].selector,b.name=e["private"].habit[d[0]].name):(b.rule=c[d[1]].habit[d[0]].selector,b.name=c[d[1]].habit[d[0]].name))):3===arguments.length&&(b.mode="add",b.type="event",b.rule="",b.id=0,b.name="",b.year=arguments[0],b.month=arguments[1]+1,b.date=arguments[2]);a.eventForm.isEditMode=!0}}]);angular.module(appName).factory("user",["$rootScope",function(a){if(localStorage&&angular.fromJson(localStorage.getItem("private"))){var c=angular.fromJson(localStorage.getItem("private"));c.isHiddenGroup=function(a){return-1!==_.indexOf(this.hiddenGroup,a,!0)};c.save=function(){a.$broadcast("updated");localStorage.setItem("private",angular.toJson(this))};c.updated=!0}else c={following:[],"private":{event:[],habit:[],name:"\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8"},hiddenGroup:[],isHiddenGroup:function(a){return-1!==
_.indexOf(this.hiddenGroup,a,!0)},save:function(){a.$broadcast("updated");localStorage.setItem("private",angular.toJson(this))}};c.save();return c}]).factory("eventForm",function(){return{isEditMode:!1,name:"",year:(new Date).getFullYear(),month:(new Date).getMonth()+1,date:(new Date).getDate(),type:"event",rule:""}}).factory("groupForm",function(){return{isEditMode:!1,name:""}}).factory("group",["$http",function(a){return[{id:0,event:[{name:"[mes]\u6625\u5206\u306e\u65e5",year:2E3,month:2,date:20},
{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2E3,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2001,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2001,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2002,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2002,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2003,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2003,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2004,
month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2004,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2005,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2005,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2006,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2006,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2007,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2007,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",
year:2008,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2008,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2009,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2009,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2010,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2010,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2011,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2011,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",
year:2012,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2012,month:8,date:22},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2013,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2013,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2014,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2014,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2015,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2015,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",
year:2016,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2016,month:8,date:22},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2017,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2017,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2018,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2018,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2019,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2019,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",
year:2020,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2020,month:8,date:22},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2021,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2021,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2022,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2022,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2023,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2023,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",
year:2024,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2024,month:8,date:22},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2025,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2025,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2026,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2026,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2027,month:2,date:21},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2027,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",
year:2028,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2028,month:8,date:22},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2029,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2029,month:8,date:23},{name:"[mes]\u6625\u5206\u306e\u65e5",year:2030,month:2,date:20},{name:"[mes]\u79cb\u5206\u306e\u65e5",year:2030,month:8,date:23},{name:"[mes]\u5341\u4e94\u591c",year:2E3,month:8,date:12},{name:"[mes]\u5341\u4e94\u591c",year:2001,month:9,date:1},{name:"[mes]\u5341\u4e94\u591c",year:2002,
month:8,date:21},{name:"[mes]\u5341\u4e94\u591c",year:2003,month:8,date:11},{name:"[mes]\u5341\u4e94\u591c",year:2004,month:8,date:28},{name:"[mes]\u5341\u4e94\u591c",year:2005,month:8,date:18},{name:"[mes]\u5341\u4e94\u591c",year:2006,month:9,date:6},{name:"[mes]\u5341\u4e94\u591c",year:2007,month:8,date:25},{name:"[mes]\u5341\u4e94\u591c",year:2008,month:8,date:14},{name:"[mes]\u5341\u4e94\u591c",year:2009,month:9,date:3},{name:"[mes]\u5341\u4e94\u591c",year:2010,month:8,date:22},{name:"[mes]\u5341\u4e94\u591c",
year:2011,month:8,date:12},{name:"[mes]\u5341\u4e94\u591c",year:2012,month:8,date:30},{name:"[mes]\u5341\u4e94\u591c",year:2013,month:8,date:19},{name:"[mes]\u5341\u4e94\u591c",year:2014,month:8,date:8},{name:"[mes]\u5341\u4e94\u591c",year:2015,month:8,date:27},{name:"[mes]\u5341\u4e94\u591c",year:2016,month:8,date:15}],habit:[{name:"[mes]\u5143\u65e6",selector:"month:1 date:1"},{name:"[mes]\u6210\u4eba\u306e\u65e5",selector:"month:1 day:2nd-mon"},{name:"[mes]\u662d\u548c\u306e\u65e5",selector:"month:4 date:29"},
{name:"[mes]\u5efa\u56fd\u8a18\u5ff5\u65e5",selector:"month:2 date:11"},{name:"[mes]\u61b2\u6cd5\u8a18\u5ff5\u65e5",selector:"month:5 date:3"},{name:"[mes]\u307f\u3069\u308a\u306e\u65e5",selector:"month:5 date:4"},{name:"[mes]\u3053\u3069\u3082\u306e\u65e5",selector:"month:5 date:5"},{name:"[mes]\u6d77\u306e\u65e5",selector:"month:7 day:3rd-mon"},{name:"[mes]\u656c\u8001\u306e\u65e5",selector:"month:9 day:3rd-mon"},{name:"[mes]\u4f53\u80b2\u306e\u65e5",selector:"month:10 day:2nd-mon"},{name:"[mes]\u6587\u5316\u306e\u65e5",
selector:"month:11 date:3"},{name:"[mes]\u52e4\u52b4\u611f\u8b1d\u306e\u65e5",selector:"month:11 date:23"},{name:"[mes]\u5929\u7687\u8a95\u751f\u65e5",selector:"month:12 date:23"}],name:"\u795d\u65e5",updated:!0}]}]).factory("calF",function(){var a=new Date,c=[];return{year:a.getFullYear(),month:a.getMonth(),date:a.getDate(),calendar:function(a,d){if(c[a-MEMO_LIMIT]){if(c[a-MEMO_LIMIT][d])return c[a-MEMO_LIMIT][d]}else c[a-MEMO_LIMIT]=[];var b=(new Date(a,d,1)).getDay(),k=[31,28,31,30,31,30,31,31,
30,31,30,31][d];1===d&&(0==a%400||0!=a%100&&0==a%4)&&(k=29);var f=[];f.year=a;f.month=d;var g=0;for(;;){f[g]=[];for(var l=1;7>=l;l++)f[g][f[g].length]=0<7*g+l-b?7*g+l-b<=k?7*g+l-b:32:0;if(f[g][f[g].length-1]>=k)break;g++}return c[a-MEMO_LIMIT][d]=f},today:{year:a.getFullYear(),month:a.getMonth(),date:a.getDate()},selected:a.getDate(),selectedDay:function(){return null==this.selected?"":"\u65e5\u6708\u706b\u6c34\u6728\u91d1\u571f".split("")[(new Date(this.year,this.month,this.selected)).getDay()]},
disableHoverEvent:isSmartPhone}}).factory("eventListToEdit",function(){return{id:""}}).factory("error",["$mdToast",function(a){var c=c||Error;return function(e){a.show(a.simple().content(e).position("top right").hideDelay(3E3));return new c(e)}}]).run(["$timeout",function(a){function c(){var d=new Date;d.setDate(d.getDate()+1);d.setHours(0);d.setMinutes(0);d.setSeconds(0);d.setMilliseconds(0);var b=new Date;$scope.calF.today.year=b.getFullYear();$scope.calF.today.month=b.getMonth();$scope.calF.today.date=
b.getDate();a(c,d-new Date)}var e=new Date;e.setDate(e.getDate()+1);e.setHours(0);e.setMinutes(0);e.setSeconds(0);e.setMilliseconds(0);a(c,e-new Date)}]).factory("db",["group","user","$http","$rootScope",function(a,c,e,d){return{post:function(a,c,f){a=_.clone(a);a.id=c;a.permission=a.permission||[];a.parents=a.parents||"";delete a.updated;for(var g in a)a[g]=angular.toJson(a[g]);a.type=f;d.$broadcast("updated");return e.post("http://www40.atpages.jp/chatblanc/genderC/database.php",a).success(function(a){console.log("updated");
console.log(a)}).error(function(a){console.log(a)})},list:function(){return e.post("http://www40.atpages.jp/chatblanc/genderC/database.php",{type:"list",groupID:c.following.join(",")}).success(function(a){return a}).error(function(a){console.log(a)})},getNameList:function(){return e.post("http://www40.atpages.jp/chatblanc/genderC/database.php",{type:"namelist"}).success(function(a){return a})}}}]);angular.module(appName).factory("eventCal",["group","user","calF","error",function(a,c,e,d){function b(a){return parseInt(a,10)}function k(b,d,e){if("private"!==b&&!a[b])return[];var t=[],x=[];"private"===b?(_.each(c.following,function(a){x=x.concat(k(a,d,e))}),t=t.concat(f(c["private"].event,d,e,"private")),x=x.concat(t),t=t.concat(g(c["private"].habit,d,e,"private",x)),c.updated=!1):(a[b].parents&&_.each(a[b].parents,function(a){x=x.concat(k(a,d,e))}),t=t.concat(f(a[b].event,d,e,b)),x=x.concat(t),
t=t.concat(g(a[b].habit,d,e,b,x)),a[b].updated=!1);return t}function f(a,b,d,c){var e=[];if(!a)return e;for(var k=0,f=a.length;k<f;k++)if(a[k].year===b&&a[k].month===d){var g=_.clone(a[k]);g.group=c;g.type="event";g.id=k;e[e.length]=g}return e}function g(c,m,f,t,x){function g(c,m,f){function D(c,m,f){var g=function(){return _.clone(y)},q=e.calendar(m,f),l={sunday:0,sun:0,"\u65e5\u66dc\u65e5":0,monday:1,mon:1,"\u6708\u66dc\u65e5":1,tuesday:2,tue:2,"\u706b\u66dc\u65e5":2,wednesday:3,wed:3,"\u6c34\u66dc\u65e5":3,
thursday:4,thu:4,"\u6728\u66dc\u65e5":4,friday:5,fri:5,"\u91d1\u66dc\u65e5":5,saturday:6,sat:6,"\u571f\u66dc\u65e5":6},B={January:0,Jan:0,"\u7766\u6708":0,February:1,Feb:1,"\u5982\u6708":1,March:2,Mar:2,"\u5f25\u751f":2,April:3,Apr:3,"\u536f\u6708":3,May:4,"\u7690\u6708":4,June:5,Jun:5,"\u6c34\u7121\u6708":5,July:6,Jul:6,"\u6587\u6708":6,August:7,Aug:7,"\u8449\u6708":7,September:8,Sep:8,"\u9577\u6708":8,October:9,Oct:9,"\u795e\u7121\u6708":9,November:10,Nov:10,"\u971c\u6708":10,December:11,Dec:11,
"\u5e2b\u8d70":11};if(w[m-MEMO_LIMIT])if(w[m-MEMO_LIMIT][f]){if(w[m-MEMO_LIMIT][f][c])return _.clone(w[m-MEMO_LIMIT][f][c])}else w[m-MEMO_LIMIT][f]={};else w[m-MEMO_LIMIT]=[],w[m-MEMO_LIMIT][f]={};var p=c.split(":")[0],h=c.split(":").slice(1).join(":"),n=[];if("not"===p)if(n=g(),"public-holiday"===h||"\u795d\u65e5"===h){q=k(0,m,f);l=0;for(h=q.length;l<h;l++)q[l]=q[l].date;n=_.difference(n,q);w[m-MEMO_LIMIT][f][c]=_.clone(n)}else if(0===h.indexOf("year")||0===h.indexOf("month")||0===h.indexOf("date")||
0===h.indexOf("day"))h=h.replace(/=/,":"),n=_.difference(g(),D(h,m,f));else{var v=h.split("=")[0],u=h.replace(/^.+?=/,""),u=u.replace(/^"(.+)"$/,"$1");_.each(x,function(a){if(a[v]===u||0===a[v].indexOf("[mes]")&&a[v].slice(5)===u)n=_.without(n,a.date)})}else if("range"===p)if(".."===h.slice(0,2))h="..."===h.slice(0,3)?h.slice(3):h.slice(2),n=g(),h=h.split("/"),h=_.map(h,b),s=new Date(h[0],h[1]-1,h[2]),s.getFullYear()<m||s.getFullYear()==m&&s.getMonth()<f?n=[]:s.getFullYear()==m&&s.getMonth()==f?(n=
g(),n=_.filter(n,function(a){return a<=s.getDate()})):n=g();else if(".."===h.slice(-2))h="..."===h.slice(-3)?h.slice(0,-3):h.slice(0,-2),h=h.split("/"),h=_.map(h,b),r=new Date(h[0],h[1]-1,h[2]),r.getFullYear()>m||r.getFullYear()==m&&r.getMonth()>f?n=[]:r.getFullYear()==m&&r.getMonth()==f?(n=g(),n=_.filter(n,function(a){return a>=r.getDate()})):n=g();else if(-1!==h.indexOf("..")){n=[];h=h.split("...");1===h.length&&(h=h[0].split(".."));var E=[],C=[],A=[],r=h[0],s=h[1],z=s.substr(s.length-4,4),F=s.substr(s.length-
5,5),q=[],r=r.split("/"),r=_.map(r,b);3===r.length?(l=new Date(r[0],r[1]-1,r[2]),q.push(l)):2===r.length&&(l=new Date(m-1,r[0]-1,r[1]),q.push(l,new Date(m,r[0]-1,r[1])));_.each(q,function(a){a.getFullYear()>m||a.getFullYear()==m&&a.getMonth()>f?E=[]:a.getFullYear()==m&&a.getMonth()==f?(E=g(),E=_.filter(E,function(b){return b>=a.getDate()})):E=g();A.push(E)});q=_.zip(q,A);_.each(q,function(a){var d=a[0];a=a[1];var c;if("date"===z||"week"===z||"year"===z||"dates"===F||"weeks"===F||"years"===F){var e;
e="date"===z||"week"===z||"year"===z?b(s.substring(0,s.length-4)):b(s.substring(0,s.length-5));c=new Date(d.getTime());"date"===z||"dates"===F?c.setDate(c.getDate()+e):"week"===z||"weeks"===F?c.setDate(c.getDate()+7*e):"year"!==z&&"years"!==F||c.setFullYear(c.getFullYear()+e)}else c=s.split("/"),c=_.map(c,b),3===c.length?c=new Date(c[0],c[1]-1,c[2]):(c=new Date(d.getFullYear(),c[0]-1,c[1]),c.getTime()<d.getTime()&&c.setFullYear(c.getFullYear()+1));c.getFullYear()<m||c.getFullYear()==m&&c.getMonth()<
f?C=[]:c.getFullYear()==m&&c.getMonth()==f?(C=g(),C=_.filter(C,function(a){return a<=c.getDate()})):C=g();_.isEmpty(_.intersection(a,C))||(n=_.intersection(a,C))})}else throw d('invalid selector "'+p+":"+h+'" in '+a[t].name+".");else if("date"===p)n[n.length]=b(h);else if("month"===p)if(!B[h]&&b(h)!=f+1||B[h]&&B[h]!=f)n=[];else{if(!B[h]&&b(h)==f+1||B[h]&&B[h]==f)n=g()}else if("day"===p)if(h.match(/^\d/)){for(var h=h.match(/^(\d+)(?:st|nd|rd|th)-?(.+)$/),B=b(h[1]),G=l[h[2]],l=0;""===q[l][G];)l++;n[n.length]=
q[l-1+B][G]}else G=l[h],_.some(q,function(a){""!==a[G]&&(n[n.length]=a[G])});else if("year"===p)n="leap-year"===h||"leap_year"===h||"\u3046\u308b\u3046\u5e74"===h||"\u958f\u5e74"===h?0===m%400||0===m%4&&0!==m%100?g():[]:b(h)!==m?[]:g();else throw d('undefined key "'+p+'".');"day"===p&&(w[m-MEMO_LIMIT][f][c]=_.clone(n));return n}var q=[],y=_.flatten(e.calendar(m,f));_.each(c,function(a){if(1===a[1])q[q.length]=D(a[0],m,f);else if(0===a[1])if("&&"===a[0])q.push(_.intersection(q.pop(),q.pop()));else if("||"===
a[0])q.push(_.union(q.pop(),q.pop()));else throw d("undefined operator "+a[0]);});if(1!=q.length)throw d("unexpected error in execSelectors().");return q.pop()}if(!c)return[];for(var p=[],y=0,u=c.length;y<u;y++){c[y].type="habit";c[y].group=t;var v=g(l(c[y].selector),m,f);_.each(v,function(a,b){v[b]={year:m,month:f,date:a,name:c[y].name,group:t,id:y,type:"habit"}});p=p.concat(v)}return p}function l(a){function b(a){""!==a[0]&&(d[d.length]=a)}if(u[a])return u[a];for(var d=[],c=!1,e=0,f=0,g=a.length;f<
g;f++){var k=a.charAt(f);if(c)'"'===k?c=!1:"\\"===k&&(f+=1);else if('"'===k)c=!0;else if(" "===k){b([a.substring(e,f),1]);var k={" and ":"&&"," \u304b\u3064 ":"&&"," && ":"&&"," or ":"||"," \u307e\u305f\u306f ":"||"," || ":"||"},l=!1,v;a:for(v in k)if(a.substr(f,v.length)===v){b([k[v],0]);e=f+v.length;f+=v.length;l=!0;break a}l||(b(["&&",0]),e=f+1,f+=1)}else if("("===k||")"===k)b([a.substring(e,f),1]),b([k,"("===k?2:3]),e=f+1}""!==a.substring(e)&&b([a.substring(e),1]);return u[a]=p(d)}function p(a){for(var b=
[],c=[],e={"||":0,"&&":1},f=0,k=a.length;f<k;f++)if(1===a[f][1])c[c.length]=a[f].concat();else if(0===a[f][1]){var g=a[f][0];b[b.length-1]&&e[g]<=e[b[b.length-1][0]]&&(c[c.length]=b.pop());b[b.length]=a[f]}else if(2===a[f][1])b[b.length]=a[f];else if(3===a[f][1]){for(;2!=b[b.length-1][1];)if(c[c.length]=b.pop(),0===b.length)throw d("found mismatched parentheses");b.pop()}for(;0<b.length;){if(2===b[b.length-1][1])throw d("found mismatched parentheses.");c[c.length]=b.pop()}return c}var w=[],u={},A=
[],H=-1,I=-1;return{eventCalendar:function(a){var b=[],d=[],f=_.difference(c.following,c.hiddenGroup);if(e.year!==H||e.month!==I)H=e.year,I=e.month,A=[];else if(_.any(f,function(a){return!0===a.updated})||c.updated)A=[];else return A[a]||[];for(var g=0,l=f.length;g<l;g++)b[b.length]=k(f[g],e.year,e.month);c.isHiddenGroup(-1)||(b[b.length]=k("private",e.year,e.month));g=0;for(l=b.length;g<l;g++)for(var f=0,p=b[g].length;f<p;f++)d[b[g][f].date]||(d[b[g][f].date]=[]),d[b[g][f].date][d[b[g][f].date].length]=
b[g][f].id+":"+b[g][f].group+":"+b[g][f].type;A=_.clone(d);return A[a]||[]},splitSelector:l}}]);
